<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/favicon.ico">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon.ico">
  <link rel="mask-icon" href="/favicon.ico" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"qiufengyu.github.io","root":"/","scheme":"Gemini","version":"7.7.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="HBase – Hadoop Database，是一个高可靠性、高性能、面向列、可伸缩的分布式存储系统，利用 HBase 技术可在廉价 PC Server 上搭建起大规模结构化存储集群。HBase可以依靠横向扩展，通过不断增加廉价的商用服务器，来增加计算和存储能力。">
<meta property="og:type" content="article">
<meta property="og:title" content="大数据之 HBase">
<meta property="og:url" content="http://qiufengyu.github.io/2015/hbase/">
<meta property="og:site_name" content="Heaven&#39;s Wall">
<meta property="og:description" content="HBase – Hadoop Database，是一个高可靠性、高性能、面向列、可伸缩的分布式存储系统，利用 HBase 技术可在廉价 PC Server 上搭建起大规模结构化存储集群。HBase可以依靠横向扩展，通过不断增加廉价的商用服务器，来增加计算和存储能力。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://www.searchtb.com/wp-content/uploads/2011/01/image0010.jpg">
<meta property="og:image" content="http://qiufengyu.github.io/2015/hbase/cf.png">
<meta property="og:image" content="http://static.oschina.net/uploads/img/201201/25091147_gmLr.jpg">
<meta property="og:image" content="http://qiufengyu.github.io/2015/hbase/locate.PNG">
<meta property="og:image" content="http://i4.hexunimg.cn/2011-10-17/134285166.jpg">
<meta property="article:published_time" content="2015-07-24T20:15:00.000Z">
<meta property="article:modified_time" content="2020-02-23T17:24:17.539Z">
<meta property="article:author" content="Godfray Qiu">
<meta property="article:tag" content="Internship">
<meta property="article:tag" content="HBase">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://www.searchtb.com/wp-content/uploads/2011/01/image0010.jpg">

<link rel="canonical" href="http://qiufengyu.github.io/2015/hbase/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: false,
    isPost: true
  };
</script>

  <title>大数据之 HBase | Heaven's Wall</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta custom-logo">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Heaven's Wall</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
        <p class="site-subtitle">落尽红樱君不见，轻绘梨花泪沾衣</p>
      <a>
        <img class="custom-logo-image" src="/images/custom-logo.jpg" alt="Heaven's Wall">
      </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>归档</a>

  </li>
  </ul>

</nav>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content">
            

  <div class="posts-expand">
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block " lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://qiufengyu.github.io/2015/hbase/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Godfray Qiu">
      <meta itemprop="description" content="清纯佳人白玫瑰，高冷酸假">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Heaven's Wall">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          大数据之 HBase
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2015-07-24 20:15:00" itemprop="dateCreated datePublished" datetime="2015-07-24T20:15:00+00:00">2015-07-24</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-02-23 17:24:17" itemprop="dateModified" datetime="2020-02-23T17:24:17+00:00">2020-02-23</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Big-Data/" itemprop="url" rel="index"><span itemprop="name">Big Data</span></a>
                </span>
            </span>

          
            <div class="post-description">HBase – Hadoop Database，是一个高可靠性、高性能、面向列、可伸缩的分布式存储系统，利用 HBase 技术可在廉价 PC Server 上搭建起大规模结构化存储集群。HBase可以依靠横向扩展，通过不断增加廉价的商用服务器，来增加计算和存储能力。</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><p>HBase – Hadoop Database，是一个高可靠性、高性能、面向列、可伸缩的分布式存储系统，利用 HBase 技术可在廉价 PC Server 上搭建起大规模结构化存储集群。HBase可以依靠横向扩展，通过不断增加廉价的商用服务器，来增加计算和存储能力。<br>HBase在整个Hadoop系统中是这样的角色：<br><img src="http://www.searchtb.com/wp-content/uploads/2011/01/image0010.jpg" alt="HBase Ecosystem"><br>上图描述了 Hadoop EcoSystem 中的各层系统，其中 HBase 位于结构化存储层，Hadoop HDFS 为 HBase 提供了高可靠性的底层存储支持，Hadoop MapReduce 为 HBase 提供了高性能的计算能力，Zookeeper 为 HBase 提供了稳定服务和 failover 机制。<br>此外，Pig 和 Hive 还为 HBase 提供了高层语言支持，使得在 HBase 上进行数据统计处理变的非常简单。 Sqoop 则为 HBase 提供了方便的 RDBMS 数据导入功能，使得传统数据库数据向 HBase 中迁移变的非常方便。<br>在HBase中的表一般有这样的特点：</p>
<ul>
<li>大：一个表可以有上亿行，上百万列</li>
<li>面向列：面向列(族)的存储和权限控制，列(族)独立检索。</li>
<li>稀疏：对于为空(null)的列，并不占用存储空间，因此，表可以设计的非常稀疏。</li>
</ul>
<h2 id="HBase数据模型"><a href="#HBase数据模型" class="headerlink" title="HBase数据模型"></a>HBase数据模型</h2><h3 id="Table-amp-Column-Family"><a href="#Table-amp-Column-Family" class="headerlink" title="Table &amp; Column Family"></a>Table &amp; Column Family</h3><p>最简单且基本的HBase中的数据主要是按照如下格式进行存储的：<br><img src="cf.png" alt="Table"></p>
<ul>
<li>Row Key: 行键，Table 的主键，Table 中的记录按照 Row Key 的【字典序】排序</li>
<li>Timestamp: 时间戳，每次数据操作对应的时间戳，可以看作是数据的 version number</li>
<li>Column Family：列簇，Table 在水平方向有一个或者多个 Column Family 组成，一个 Column Family 中可以由任意多个 Column 组成，即 Column Family 支持动态扩展，无需预先定义 Column 的数量以及类型，所有 Column 均以二进制格式存储，用户需要自行进行类型转换。</li>
<li>Cell：由 {row key, column( =family + label), timestamp} 唯一确定的单元。cell 中的数据是没有类型的，全部是字节码形式存贮。</li>
</ul>
<h3 id="Table-amp-Region"><a href="#Table-amp-Region" class="headerlink" title="Table &amp; Region"></a>Table &amp; Region</h3><p>当Table随着记录数不断增加而变大后，当达到一个设定阈值时，会逐渐分裂成多份 splits，成为 regions，一个 region 由 [startkey,endkey) 表示，不同的 region 会被 Master 分配给相应的 RegionServer 进行管理。HTable 将根据行被拆分为 HRigion 进行管理，而当某个 HRigion 过大时，又会自动分解为多个 HRigion 来维护数据，HRigion是这里分布式存储和负载均衡的最小单元。不同的 Hregion 可以分布在不同的 HRegion server 上，但一个 Hregion 是不会拆分到多个 server 上的。<br>HRegion 虽然是分布式存储的最小单元，但并不是存储的最小单元。事实上，HRegion 由一个或者多个 Store 组成，每个 store 保存一个 columns family。每个 Store 又由一个 memStore 和 0 至多个 StoreFile 组成。</p>
<h3 id="ROOT-amp-META-Table"><a href="#ROOT-amp-META-Table" class="headerlink" title="-ROOT- &amp; .META. Table"></a>-ROOT- &amp; .META. Table</h3><p>HBase 中有两张特殊的 Table，-ROOT- 和 .META.<br><img src="http://static.oschina.net/uploads/img/201201/25091147_gmLr.jpg" alt="Root meta"></p>
<ul>
<li>.META.：记录了用户表的 Region 信息，.META. 可以有多个 regoin</li>
<li>-ROOT-：记录了 .META. 表的 Region 信息，-ROOT- 只有一个 region</li>
<li>Zookeeper 中记录了 -ROOT- 表的 location</li>
</ul>
<p>Client访问用户数据之前需要首先访问 zookeeper，然后访问 -ROOT- 表，接着访问 .META. 表，最后才能找到用户数据的位置去访问，中间需要多次网络操作，不过 client 端会做 cache 缓存。<br>Reference: <a href="http://www.searchtb.com/2011/01/understanding-hbase.html" target="_blank" rel="noopener">HBase技术介绍</a></p>
<h2 id="关键算法和流程"><a href="#关键算法和流程" class="headerlink" title="关键算法和流程"></a>关键算法和流程</h2><h3 id="Region-定位"><a href="#Region-定位" class="headerlink" title="Region 定位"></a>Region 定位</h3><p>系统如何找到某个 row key (或者某个 row key range)所在的 region? bigtable 使用三层类似 B+ 树的结构来保存 region 位置。<br><img src="locate.PNG" alt="Region定位"></p>
<ul>
<li>第一层是保存 zookeeper 里面的文件，它持有 root region 的位置。</li>
<li>第二层 root region 是 .META. 表的第一个 region 其中保存了 .META.z 表其它 region 的位置。通过 root region，我们就可以访问 .META. 表的数据。</li>
<li>.META. 是第三层，它是一个特殊的表，保存了 HBase 中所有数据表的 region 位置信息。</li>
</ul>
<p><strong>说明：</strong></p>
<ol>
<li>root region 永远不会被 split，保证了最多需要三次跳转，就能定位到任意region。</li>
<li>.META. 表每行保存一个 region 的位置信息，row key 采用表名+表的最后一样编码而成。</li>
<li>为了加快访问，.META. 表的全部 region 都保存在内存中。假设，.META. 表的一行在内存中大约占用 1KB。并且每个 region 限制为 128MB。那么上面的三层结构可以保存的 region 数目为：$(128MB/1KB) \times (128MB/1KB) = 2^{34}$ 个 region</li>
<li>client 会将查询过的位置信息保存缓存起来，缓存不会主动失效，因此如果 client 上的缓存全部失效，则需要进行 6 次网络来回，才能定位到正确的 region(其中三次用来发现缓存失效，另外三次用来获取位置信息)。</li>
</ol>
<h3 id="读写过程"><a href="#读写过程" class="headerlink" title="读写过程"></a>读写过程</h3><p>上文提到，HBase 使用 MemStore 和 StoreFile 存储对表的更新。<br>数据在更新时首先写入 Log(WAL log)和内存(MemStore)中，MemStore 中的数据是排序的，当 MemStore 累计到一定阈值时，就会创建一个新的 MemStore，并且将老的 MemStore 添加到 flush 队列，由单独的线程 flush 到磁盘上，成为一个 StoreFile。与此同时，系统会在 zookeeper 中记录一个 redo point，表示这个时刻之前的变更已经持久化了。(minor compact)<br>当系统出现意外时，可能导致内存(MemStore)中的数据丢失，此时使用 Log(WAL log)来恢复 checkpoint 之后的数据。<br>前面提到过 StoreFile 是只读的，一旦创建后就不可以再修改。因此 HBase 的更新其实是不断追加的操作。当一个 Store 中的 StoreFile 达到一定的阈值后，就会进行一次合并(major compact),将对同一个 key 的修改合并到一起，形成一个大的 StoreFile，当 StoreFile 的大小达到一定阈值后，又会对 StoreFile 进行 split，等分为两个 StoreFile。<br>由于对表的更新是不断追加的，处理读请求时，需要访问 Store 中全部的 StoreFile 和 MemStore，将他们的按照 row key 进行合并，由于 StoreFile 和 MemStore 都是经过排序的，并且 StoreFile 带有内存中索引，合并的过程还是比较快。</p>
<h3 id="写请求处理过程"><a href="#写请求处理过程" class="headerlink" title="写请求处理过程"></a>写请求处理过程</h3><p><img src="http://i4.hexunimg.cn/2011-10-17/134285166.jpg" alt="写请求处理"></p>
<ol>
<li>client 向 region server 提交写请求</li>
<li>region server 找到目标region</li>
<li>region 检查数据是否与 schema 一致</li>
<li>如果客户端没有指定版本，则获取当前系统时间作为数据版本</li>
<li>将更新写入 WAL log</li>
<li>将更新写入 Memstore</li>
<li>判断 Memstore 的是否需要 flush 为 Store 文件</li>
</ol>
<h3 id="region-分配"><a href="#region-分配" class="headerlink" title="region 分配"></a>region 分配</h3><p>任何时刻，一个 region 只能分配给一个 region server。master 记录了当前有哪些可用的 region server。以及当前哪些 region 分配给了哪些 region server，哪些 region 还没有分配。当存在未分配的 region，并且有一个 region server 上有可用空间时，master 就给这个 region server 发送一个装载请求，把 region 分配给这个r egion server。region server 得到请求后，就开始对此 region 提供服务。</p>
<h3 id="region-server-上线"><a href="#region-server-上线" class="headerlink" title="region server 上线"></a>region server 上线</h3><p>master 使用 zookeeper 来跟踪 region server 状态。当某个 region server 启动时，会首先在 zookeeper 上的 server 目录下建立代表自己的文件，并获得该文件的独占锁。由于 master 订阅了 server 目录上的变更消息，当 server 目录下的文件出现新增或删除操作时，master 可以得到来自 zookeeper 的实时通知。因此一旦 region server 上线，master 能马上得到消息。</p>
<h3 id="region-server-下线"><a href="#region-server-下线" class="headerlink" title="region server 下线"></a>region server 下线</h3><p>当 region server 下线时，它和 zookeeper 的会话断开，zookeeper 而自动释放代表这台 server 的文件上的独占锁。而 master 不断轮询 server 目录下文件的锁状态。如果 master 发现某个 region server 丢失了它自己的独占锁，(或者 master 连续几次和 region server 通信都无法成功)，master 就是尝试去获取代表这个 region server 的读写锁，一旦获取成功，就可以确定：</p>
<ol>
<li>region server 和 zookeeper 之间的网络断开了。</li>
<li>region server 挂了。</li>
</ol>
<p>的其中一种情况发生了，无论哪种情况，region server 都无法继续为它的 region 提供服务了，此时 master 会删除 server 目录下代表这台 region server 的文件，并将这台 region server 的 region 分配给其它还活着的同志。<br>如果网络短暂出现问题导致 region server 丢失了它的锁，那么 region server 重新连接到 zookeeper 之后，只要代表它的文件还在，它就会不断尝试获取这个文件上的锁，一旦获取到了，就可以继续提供服务。</p>
<h3 id="master-上线"><a href="#master-上线" class="headerlink" title="master 上线"></a>master 上线</h3><p>master 启动进行以下步骤:</p>
<ol>
<li>从 zookeeper 上获取唯一一个代码 master 的锁，用来阻止其它 master 成为 master 。</li>
<li>扫描 zookeeper 上的 server 目录，获得当前可用的 region server 列表。</li>
<li>和2中的每个 region server 通信，获得当前已分配的 region和region server 的对应关系。</li>
<li>扫描 .META.region 的集合，计算得到当前还未分配的 region，将他们放入待分配 region 列表。</li>
</ol>
<h3 id="master-下线"><a href="#master-下线" class="headerlink" title="master 下线"></a>master 下线</h3><p>由于 master 只维护表和 region 的元数据，而不参与表数据 IO 的过程，master 下线仅导致所有元数据的修改被冻结(无法创建删除表，无法修改表的 schema，无法进行 region 的负载均衡，无法处理 region 上下线，无法进行 region 的合并，唯一例外的是 region 的 split 可以正常进行，因为只有 region server 参与)，表的数据读写还可以正常进行。因此 master 下线短时间内对整个 HBase 集群没有影响。从上线过程可以看到，master 保存的信息全是可以冗余信息(都可以从系统其它地方收集到或者计算出来)，因此，一般 HBase 集群中总是有一个 master 在提供服务，还有一个以上的 “master” 在等待时机抢占它的位置。<br>Reference: <a href="http://tech.hexun.com/2011-10-17/134285153.html" target="_blank" rel="noopener">NoSQL：列存储数据库之HBase介绍</a></p>
<h2 id="快速入门"><a href="#快速入门" class="headerlink" title="快速入门"></a>快速入门</h2><h3 id="运行环境"><a href="#运行环境" class="headerlink" title="运行环境"></a>运行环境</h3><p>操作系统：CentOS 6.5（64位）（VMware 虚拟机）<br>JDK 版本：<a href="http://www.oracle.com/technetwork/java/javase/downloads/java-archive-downloads-javase7-521261.html#jdk-7u79-oth-JPR" target="_blank" rel="noopener">1.7.0_79</a>（对 1.8 的支持可能存在一些问题，建议 1.7 即可，而 1.6 则可能不支持）<br>HBase版本：<a href="http://www.apache.org/dyn/closer.cgi/hbase/" target="_blank" rel="noopener">1.0.1.1</a>，请选择稳定版！</p>
<h3 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h3><p>首先是解压缩：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tar xzvf hbase-1.0.1.1-bin.tar.gz</span><br><span class="line"><span class="built_in">cd</span> hbase-1.0.1.1</span><br></pre></td></tr></table></figure>
<p>此外还需要配置 JAVA 环境信息（如果你不是默认 Java 路径的话）,修改目录 <code>conf/hbase-env.sh</code> 中的 <code>JAVA_HOME</code> 变量值为你的 Java 路径。<br>当然，还需要编辑 <code>conf/hbase-site.xml</code> 内容，这是因为可以在下次启动时可以直接加载这些内容，以免系统重启时删除缓存文件。</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>hbase.rootdir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>file:///home/user/hbase<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>hbase.zookeeper.property.dataDir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>/home/user/zookeeper<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="创建连接"><a href="#创建连接" class="headerlink" title="创建连接"></a>创建连接</h3><p>首先，输入</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">bin/start-hbase.sh</span><br></pre></td></tr></table></figure>
<p>启动 HBase 服务，如果提示 Permission Denied 请使用 sudo 权限或是进入 su 模式操作。接着输入</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">./bin/hbase shell</span><br></pre></td></tr></table></figure>
命令进行连接，连接成功后，即能进入HBase的命令行操作模式<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hbase(main):001:0&gt;</span><br></pre></td></tr></table></figure>
<p>输入 <code>help</code> 可以查看帮助菜单，现在你可以输入 <code>whoami</code> 指令查看当前的连接信息，得到结果<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">user (auth:SIMPLE)</span><br><span class="line">	groups: user</span><br></pre></td></tr></table></figure></p>
<h3 id="HTable操作"><a href="#HTable操作" class="headerlink" title="HTable操作"></a>HTable操作</h3><p>表的创建使用命令</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">create <span class="string">'test'</span>, <span class="string">'cf1'</span>, <span class="string">'cf2'</span>, <span class="string">'cf3'</span></span><br></pre></td></tr></table></figure>
返回结果：<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">0 row(s) <span class="keyword">in</span> 0.8070 seconds</span><br><span class="line">=&gt; Hbase::Table - <span class="built_in">test</span></span><br></pre></td></tr></table></figure>
<p>使用<code>list</code>命令可以查看当前表的信息：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">TABLE                                                                           </span><br><span class="line"><span class="built_in">test</span>                                                                            </span><br><span class="line">1 row(s) <span class="keyword">in</span> 0.0880 seconds</span><br><span class="line"></span><br><span class="line">=&gt; [<span class="string">"test"</span>]</span><br></pre></td></tr></table></figure>
<p>如果想要查看表的结构，使用<code>describe</code>命令</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">describe <span class="string">'test'</span></span><br><span class="line">Table <span class="built_in">test</span> is ENABLED                                                           </span><br><span class="line"><span class="built_in">test</span>                                                                            </span><br><span class="line">COLUMN FAMILIES DESCRIPTION                                                     </span><br><span class="line">&#123;NAME =&gt; <span class="string">'cf1'</span>, DATA_BLOCK_ENCODING =&gt; <span class="string">'NONE'</span>, BLOOMFILTER =&gt; <span class="string">'ROW'</span>, REPLICATION</span><br><span class="line">_SCOPE =&gt; <span class="string">'0'</span>, VERSIONS =&gt; <span class="string">'1'</span>, COMPRESSION =&gt; <span class="string">'NONE'</span>, MIN_VERSIONS =&gt; <span class="string">'0'</span>, TTL </span><br><span class="line">=&gt; <span class="string">'FOREVER'</span>, KEEP_DELETED_CELLS =&gt; <span class="string">'FALSE'</span>, BLOCKSIZE =&gt; <span class="string">'65536'</span>, IN_MEMORY =&gt; </span><br><span class="line"><span class="string">'false'</span>, BLOCKCACHE =&gt; <span class="string">'true'</span>&#125;                                                  </span><br><span class="line">&#123;NAME =&gt; <span class="string">'cf2'</span>, DATA_BLOCK_ENCODING =&gt; <span class="string">'NONE'</span>, BLOOMFILTER =&gt; <span class="string">'ROW'</span>, REPLICATION</span><br><span class="line">_SCOPE =&gt; <span class="string">'0'</span>, VERSIONS =&gt; <span class="string">'1'</span>, COMPRESSION =&gt; <span class="string">'NONE'</span>, MIN_VERSIONS =&gt; <span class="string">'0'</span>, TTL </span><br><span class="line">=&gt; <span class="string">'FOREVER'</span>, KEEP_DELETED_CELLS =&gt; <span class="string">'FALSE'</span>, BLOCKSIZE =&gt; <span class="string">'65536'</span>, IN_MEMORY =&gt; </span><br><span class="line"><span class="string">'false'</span>, BLOCKCACHE =&gt; <span class="string">'true'</span>&#125;                                                  </span><br><span class="line">&#123;NAME =&gt; <span class="string">'cf3'</span>, DATA_BLOCK_ENCODING =&gt; <span class="string">'NONE'</span>, BLOOMFILTER =&gt; <span class="string">'ROW'</span>, REPLICATION</span><br><span class="line">_SCOPE =&gt; <span class="string">'0'</span>, VERSIONS =&gt; <span class="string">'1'</span>, COMPRESSION =&gt; <span class="string">'NONE'</span>, MIN_VERSIONS =&gt; <span class="string">'0'</span>, TTL </span><br><span class="line">=&gt; <span class="string">'FOREVER'</span>, KEEP_DELETED_CELLS =&gt; <span class="string">'FALSE'</span>, BLOCKSIZE =&gt; <span class="string">'65536'</span>, IN_MEMORY =&gt; </span><br><span class="line"><span class="string">'false'</span>, BLOCKCACHE =&gt; <span class="string">'true'</span>&#125;                                                  </span><br><span class="line">3 row(s) <span class="keyword">in</span> 0.0660 seconds </span><br></pre></td></tr></table></figure>
<p>使用<code>put</code>指令插入数据，并且插入成功则会有提示，如果语法错误，会有正确的格式提示。修改内容可以重复使用<code>put</code>，会以最后一次<code>put</code>结果为最终结果</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">put <span class="string">'test'</span>, <span class="string">'row1'</span>, <span class="string">'cf1:a'</span>, <span class="string">'value1'</span></span><br><span class="line">0 row(s) <span class="keyword">in</span> 0.4560 seconds</span><br><span class="line"></span><br><span class="line">put <span class="string">'test'</span>, <span class="string">'row1'</span>, <span class="string">'cf1:b'</span>, <span class="string">'value2'</span></span><br><span class="line">0 row(s) <span class="keyword">in</span> 0.0080 seconds</span><br><span class="line"></span><br><span class="line">put <span class="string">'test'</span>, <span class="string">'row1'</span>, <span class="string">'cf2:aa'</span>, <span class="string">'value11'</span></span><br><span class="line">0 row(s) <span class="keyword">in</span> 0.0160 seconds</span><br><span class="line"></span><br><span class="line">put <span class="string">'test'</span>, <span class="string">'row1'</span>, <span class="string">'cf3:aa'</span>, <span class="string">'value33'</span></span><br><span class="line">0 row(s) <span class="keyword">in</span> 0.0720 seconds</span><br><span class="line"></span><br><span class="line">put <span class="string">'test'</span>, <span class="string">'row2'</span>, <span class="string">'cf3:aa'</span>, <span class="string">'value00'</span></span><br><span class="line">0 row(s) <span class="keyword">in</span> 0.0070 seconds</span><br><span class="line"></span><br><span class="line">put <span class="string">'test'</span>, <span class="string">'row2'</span>, <span class="string">'cf2:bb'</span>, <span class="string">'valuez'</span></span><br><span class="line">0 row(s) <span class="keyword">in</span> 0.0090 seconds</span><br><span class="line"></span><br><span class="line">put <span class="string">'test'</span>, <span class="string">'row3'</span>, <span class="string">'cf1:yy'</span>, <span class="string">'1'</span></span><br><span class="line">0 row(s) <span class="keyword">in</span> 0.0130 seconds</span><br><span class="line"></span><br><span class="line"> put <span class="string">'test'</span>, <span class="string">'row3'</span>, <span class="string">'cf1:a'</span>, <span class="string">'1'</span></span><br><span class="line">0 row(s) <span class="keyword">in</span> 0.0110 seconds</span><br><span class="line"></span><br><span class="line">put <span class="string">'test'</span>, <span class="string">'row3'</span>, <span class="string">'cf1:a'</span>, <span class="string">'2'</span></span><br><span class="line">0 row(s) <span class="keyword">in</span> 0.0090 seconds</span><br></pre></td></tr></table></figure>
<p>使用<code>scan</code>命令查询一张表的内容：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">scan <span class="string">'test'</span></span><br><span class="line">ROW                   COLUMN+CELL                                               </span><br><span class="line"> row1                 column=cf1:a, timestamp=1437727890775, value=value1       </span><br><span class="line"> row1                 column=cf1:b, timestamp=1437727903128, value=value2       </span><br><span class="line"> row1                 column=cf2:aa, timestamp=1437727922351, value=value11     </span><br><span class="line"> row1                 column=cf3:aa, timestamp=1437727934848, value=value33     </span><br><span class="line"> row2                 column=cf2:bb, timestamp=1437727960463, value=valuez      </span><br><span class="line"> row2                 column=cf3:aa, timestamp=1437727948328, value=value00     </span><br><span class="line"> row3                 column=cf1:a, timestamp=1437727995468, value=2            </span><br><span class="line"> row3                 column=cf1:yy, timestamp=1437727983439, value=1           </span><br><span class="line">3 row(s) <span class="keyword">in</span> 0.0850 seconds </span><br></pre></td></tr></table></figure>
<p>如果你想要查询一个Key下的内容，对应地使用<code>get</code>指令：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">get <span class="string">'test'</span>, <span class="string">'row1'</span></span><br><span class="line">COLUMN                CELL                                                      </span><br><span class="line"> cf1:a                timestamp=1437727890775, value=value1                     </span><br><span class="line"> cf1:b                timestamp=1437727903128, value=value2                     </span><br><span class="line"> cf2:aa               timestamp=1437727922351, value=value11                    </span><br><span class="line"> cf3:aa               timestamp=1437727934848, value=value33                    </span><br><span class="line">4 row(s) <span class="keyword">in</span> 0.0570 seconds</span><br></pre></td></tr></table></figure>
<p>如果你想要删除一张表，首先需要使用 <code>disable</code> 命令才能再使用 <code>drop</code> 命令，与 <code>disable</code> 对应的则是 <code>enable</code> 命令</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">disable</span> <span class="string">'test'</span></span><br><span class="line">0 row(s) <span class="keyword">in</span> 1.9220 seconds</span><br><span class="line">drop <span class="string">'test'</span></span><br><span class="line">0 row(s) <span class="keyword">in</span> 0.2220 seconds</span><br></pre></td></tr></table></figure>
<p>退出后，停止HBase服务：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">./bin/stop-hbase.sh</span><br><span class="line">stopping hbase....................</span><br></pre></td></tr></table></figure>

<h3 id="本地伪分布式存储"><a href="#本地伪分布式存储" class="headerlink" title="本地伪分布式存储"></a>本地伪分布式存储</h3><p>请参照<a href="http://hbase.apache.org/book.html" target="_blank" rel="noopener">Apache HBase官方指导文档</a></p>
<h2 id="Java-API使用"><a href="#Java-API使用" class="headerlink" title="Java API使用"></a>Java API使用</h2><p>这里使用 Eclipse，导入了 HBase 包下 lib 的所有 jar 作为依赖库。并且把hbase-site.xml 配置文件也放在工程目录下，此外你还需要 log4j.jar 包的支持。下面只是一个简单的创建表、插入数据、查询数据的示例</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.commons.logging.Log;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.logging.LogFactory;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.conf.Configuration; </span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.HBaseConfiguration; </span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.HColumnDescriptor; </span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.HTableDescriptor;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.KeyValue;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.MasterNotRunningException;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.TableName;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.ZooKeeperConnectionException;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.client.Admin;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.client.Connection;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.client.ConnectionFactory;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.client.Get;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.client.HTable;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.client.Put;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.client.Result;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.client.ResultScanner;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.client.Scan;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hbase.util.Bytes;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Example</span> </span>&#123; </span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> Log logger = LogFactory.getLog(Example<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String TABLE_NAME = <span class="string">"blog"</span>;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String CF_1 = <span class="string">"title"</span>;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String CF_2 = <span class="string">"author"</span>;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String CF_3 = <span class="string">"time"</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">createTables</span><span class="params">(Configuration config)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">		Connection connection = ConnectionFactory.createConnection(config);</span><br><span class="line">		Admin admin = connection.getAdmin();</span><br><span class="line">		HTableDescriptor table = <span class="keyword">new</span> HTableDescriptor(TableName.valueOf(TABLE_NAME));</span><br><span class="line">		table.addFamily(<span class="keyword">new</span> HColumnDescriptor(CF_1));</span><br><span class="line">		table.addFamily(<span class="keyword">new</span> HColumnDescriptor(CF_2));</span><br><span class="line">		table.addFamily(<span class="keyword">new</span> HColumnDescriptor(CF_3));		</span><br><span class="line">		logger.debug(<span class="string">"Creating table."</span>);</span><br><span class="line">		createOrOverwrite(admin, table);</span><br><span class="line">		logger.info(<span class="string">"Done."</span>);</span><br><span class="line">	&#125;	</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">createOrOverwrite</span><span class="params">(Admin admin, HTableDescriptor table)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		<span class="keyword">if</span> (admin.tableExists(table.getTableName())) &#123;</span><br><span class="line">			admin.disableTable(table.getTableName());</span><br><span class="line">			admin.deleteTable(table.getTableName());</span><br><span class="line">		&#125;</span><br><span class="line">		admin.createTable(table);		</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">addTable</span><span class="params">(Configuration config)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">		HTable table =<span class="keyword">new</span> HTable(config, Bytes.toBytes(TABLE_NAME));</span><br><span class="line">		Put put = <span class="keyword">new</span> Put(Bytes.toBytes(<span class="string">"demon"</span>));</span><br><span class="line">		put.add(Bytes.toBytes(CF_1), Bytes.toBytes(<span class="string">"givenName"</span>), Bytes.toBytes(<span class="string">"John"</span>));</span><br><span class="line">		put.add(Bytes.toBytes(CF_1), Bytes.toBytes(<span class="string">"mi"</span>), Bytes.toBytes(<span class="string">"M"</span>));</span><br><span class="line">		put.add(Bytes.toBytes(CF_2), Bytes.toBytes(<span class="string">"surame"</span>), Bytes.toBytes(<span class="string">"Doe"</span>));</span><br><span class="line">		put.add(Bytes.toBytes(CF_3), Bytes.toBytes(<span class="string">"email"</span>), Bytes.toBytes(<span class="string">"john.m.doe@gmail.com"</span>));</span><br><span class="line">		table.put(put);</span><br><span class="line">		table.flushCommits();</span><br><span class="line">		table.close();		</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">modifyTable</span><span class="params">(Configuration config)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">		Connection connection = ConnectionFactory.createConnection(config);</span><br><span class="line">		Admin admin = connection.getAdmin();</span><br><span class="line">	        TableName tableName = TableName.valueOf(TABLE_NAME);</span><br><span class="line">	        <span class="keyword">if</span> (admin.tableExists(tableName)) &#123;</span><br><span class="line">	        	System.out.println(<span class="string">"Table does not exist."</span>);</span><br><span class="line">	        	System.exit(-<span class="number">1</span>);</span><br><span class="line">	        &#125;        </span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">queryAll</span><span class="params">(Configuration config)</span> </span>&#123;  </span><br><span class="line">		HTable table;</span><br><span class="line">		Scan s = <span class="keyword">new</span> Scan();</span><br><span class="line">        	ResultScanner rs;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			table = <span class="keyword">new</span> HTable(config, Bytes.toBytes(TABLE_NAME));</span><br><span class="line">			rs = table.getScanner(s);</span><br><span class="line">			<span class="keyword">for</span>(Result r:rs) &#123;</span><br><span class="line">		        	System.out.println(<span class="string">"Scan: "</span>+r);</span><br><span class="line">		        	<span class="keyword">for</span> (KeyValue keyValue : r.raw()) &#123; </span><br><span class="line">	                	System.out.println(<span class="string">"列："</span> + <span class="keyword">new</span> String(keyValue.getFamily()) </span><br><span class="line">	                            + <span class="string">"====值:"</span> + <span class="keyword">new</span> String(keyValue.getValue())); </span><br><span class="line">                		&#125; </span><br><span class="line">	        	&#125;</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			<span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;       </span><br><span class="line">	&#125;  </span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">queryByRow</span><span class="params">(Configuration config)</span> <span class="keyword">throws</span> IOException </span>&#123;  </span><br><span class="line">		  </span><br><span class="line">		HTable table = <span class="keyword">new</span> HTable(config, Bytes.toBytes(TABLE_NAME));  </span><br><span class="line">	        Get get = <span class="keyword">new</span> Get(<span class="string">"demon"</span>.getBytes());  </span><br><span class="line">	        Result rs = table.get(get);</span><br><span class="line">	        <span class="keyword">for</span>(KeyValue kv : rs.raw())&#123;  </span><br><span class="line">			System.out.print(<span class="keyword">new</span> String(kv.getRow()) + <span class="string">" "</span> );  </span><br><span class="line">			System.out.print(<span class="keyword">new</span> String(kv.getFamily()) + <span class="string">":"</span> );  </span><br><span class="line">			System.out.print(<span class="keyword">new</span> String(kv.getQualifier()) + <span class="string">" "</span> );    </span><br><span class="line">			System.out.print(<span class="string">"value: "</span>+<span class="keyword">new</span> String(kv.getValue())); </span><br><span class="line">			System.out.println(<span class="string">" timestamp: "</span> +kv.getTimestamp());</span><br><span class="line">	        &#125;  </span><br><span class="line">    	&#125;  </span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> MasterNotRunningException, ZooKeeperConnectionException, IOException </span>&#123;</span><br><span class="line">		Configuration config = <span class="keyword">new</span> Configuration();</span><br><span class="line">		config.addResource(<span class="string">"hbase-site.xml"</span>);<span class="comment">//可以指定文件加载</span></span><br><span class="line">		config = HBaseConfiguration.create(config);</span><br><span class="line">		<span class="comment">// createTables(config);	</span></span><br><span class="line">		<span class="comment">// addTable(config);</span></span><br><span class="line">		<span class="comment">// queryAll(config);</span></span><br><span class="line">		queryByRow(config);</span><br><span class="line">	&#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>运行结束后，使用 <code>list</code> 命令查看，发现新增了一张叫做 blog 的表。使用 <code>scan</code>命令查看，发现 blog 表中的确插入了名为 ‘demon’ 的一行数据。当然，也可以使用 java 的 API 来进行查询操作。而删除和 disable 则不再赘述，请参照 <a href="http://www.open-open.com/lib/view/open1342514370807.html" target="_blank" rel="noopener">HBase Java API</a> 内容，以及这个 <a href="http://hbase.apache.org/apidocs/index.html" target="_blank" rel="noopener">官方API文档</a>。</p>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Internship/" rel="tag"># Internship</a>
              <a href="/tags/HBase/" rel="tag"># HBase</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2015/kafka/" rel="prev" title="大数据之 Kafka">
      <i class="fa fa-chevron-left"></i> 大数据之 Kafka
    </a></div>
      <div class="post-nav-item">
    <a href="/2016/code-recommendation/" rel="next" title="Code Recommendation Project">
      Code Recommendation Project <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  

  </div>


          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let activeClass = CONFIG.comments.activeClass;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#概述"><span class="nav-number">1.</span> <span class="nav-text">概述</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#HBase数据模型"><span class="nav-number">2.</span> <span class="nav-text">HBase数据模型</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Table-amp-Column-Family"><span class="nav-number">2.1.</span> <span class="nav-text">Table &amp; Column Family</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Table-amp-Region"><span class="nav-number">2.2.</span> <span class="nav-text">Table &amp; Region</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ROOT-amp-META-Table"><span class="nav-number">2.3.</span> <span class="nav-text">-ROOT- &amp; .META. Table</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#关键算法和流程"><span class="nav-number">3.</span> <span class="nav-text">关键算法和流程</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Region-定位"><span class="nav-number">3.1.</span> <span class="nav-text">Region 定位</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#读写过程"><span class="nav-number">3.2.</span> <span class="nav-text">读写过程</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#写请求处理过程"><span class="nav-number">3.3.</span> <span class="nav-text">写请求处理过程</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#region-分配"><span class="nav-number">3.4.</span> <span class="nav-text">region 分配</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#region-server-上线"><span class="nav-number">3.5.</span> <span class="nav-text">region server 上线</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#region-server-下线"><span class="nav-number">3.6.</span> <span class="nav-text">region server 下线</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#master-上线"><span class="nav-number">3.7.</span> <span class="nav-text">master 上线</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#master-下线"><span class="nav-number">3.8.</span> <span class="nav-text">master 下线</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#快速入门"><span class="nav-number">4.</span> <span class="nav-text">快速入门</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#运行环境"><span class="nav-number">4.1.</span> <span class="nav-text">运行环境</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#准备工作"><span class="nav-number">4.2.</span> <span class="nav-text">准备工作</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#创建连接"><span class="nav-number">4.3.</span> <span class="nav-text">创建连接</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#HTable操作"><span class="nav-number">4.4.</span> <span class="nav-text">HTable操作</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#本地伪分布式存储"><span class="nav-number">4.5.</span> <span class="nav-text">本地伪分布式存储</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Java-API使用"><span class="nav-number">5.</span> <span class="nav-text">Java API使用</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Godfray Qiu"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">Godfray Qiu</p>
  <div class="site-description" itemprop="description">清纯佳人白玫瑰，高冷酸假</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">33</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">9</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">50</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/qiufengyu" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;qiufengyu" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:mrqiufengyu@gmail.com" title="E-Mail → mailto:mrqiufengyu@gmail.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://weibo.com/237533031" title="Weibo → https:&#x2F;&#x2F;weibo.com&#x2F;237533031" rel="noopener" target="_blank"><i class="fa fa-fw fa-weibo"></i>Weibo</a>
      </span>
      <span class="links-of-author-item">
        <a href="http://space.bilibili.com/6625805" title="Bilibili → http:&#x2F;&#x2F;space.bilibili.com&#x2F;6625805" rel="noopener" target="_blank"><i class="fa fa-fw fa-bomb"></i>Bilibili</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://twitter.com/GodfrayQiu" title="Twitter → https:&#x2F;&#x2F;twitter.com&#x2F;GodfrayQiu" rel="noopener" target="_blank"><i class="fa fa-fw fa-twitter"></i>Twitter</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.facebook.com/qiufengyu" title="Facebook → https:&#x2F;&#x2F;www.facebook.com&#x2F;qiufengyu" rel="noopener" target="_blank"><i class="fa fa-fw fa-facebook"></i>Facebook</a>
      </span>
      <span class="links-of-author-item">
        <a href="http://instagram.com/godfrayqiu" title="Instagram → http:&#x2F;&#x2F;instagram.com&#x2F;godfrayqiu" rel="noopener" target="_blank"><i class="fa fa-fw fa-instagram"></i>Instagram</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.linkedin.com/in/qiufengyu" title="LinkedIn → https:&#x2F;&#x2F;www.linkedin.com&#x2F;in&#x2F;qiufengyu" rel="noopener" target="_blank"><i class="fa fa-fw fa-linkedin"></i>LinkedIn</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

<div class="copyright">
  
  &copy; 2014 – 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Godfray Qiu</span>
</div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  











<script>
if (document.querySelectorAll('div.pdf').length) {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/pdfobject@2/pdfobject.min.js', () => {
    document.querySelectorAll('div.pdf').forEach(element => {
      PDFObject.embed(element.getAttribute('target'), element, {
        pdfOpenParams: {
          navpanes : 0,
          toolbar  : 0,
          statusbar: 0,
          pagemode : 'thumbs',
          view     : 'FitH'
        },
        PDFJS_URL: '/lib/pdf/web/viewer.html',
        height: element.getAttribute('height') || '1220px'
      });
    });
  }, window.PDFObject);
}
</script>




  

  

  

</body>
</html>
